<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Julia Webstack</title>
    <meta name="description" content="Documentation for the Julia webstack">
    <meta name="viewport" content="width=device-width">

    <link href='http://fonts.googleapis.com/css?family=Oxygen+Mono|Open+Sans:400italic,400,700|Cardo' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/normalize.min.css">
    <link rel="stylesheet" href="css/main.css">

    <!--[if lt IE 9]>
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <script>window.html5 || document.write('<script src="js/vendor/html5shiv.js"><\/script>')</script>
    <![endif]-->
</head>
<body>
    <div id="universe">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
        <!-- site header, nav between package docs -->
        <div id="topbar">
            <header>
                <nav>
                    <ul>
                        <li><a href="#Morsel">Morsel</a></li>
                        <li><a href="#Meddle">Meddle</a></li>
                        <li><a href="#WebSockets">WebSockets</a></li>
                        <li><a href="#HttpServer">HttpServer</a></li>
                        <li><a href="#HttpParser">HttpParser</a></li>
                        <li><a href="#HttpCommon">HttpCommon</a></li>
                    </ul>
                </nav>
            </header>
        </div>
        <!-- document content -->
        <article id="Morsel">
            <!--!!!Morsel_content-->
<h1>Morsel</h1>
<p>Morsel is a Sintra-like micro framework for declaring routes and handling requests.
It is built on top of <a href="https://github.com/hackerschool/HttpServer.jl">HttpServer.jl</a>
and <a href="https://github.com/hackerschool/Meddle.jl">Meddle.jl</a>.</p>
<h2>Installation</h2>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># in REQUIRE</span>
Morsel

<span style="color: #408080; font-style: italic"># in REPL</span>
julia<span style="color: #666666">&gt;</span> Pkg<span style="color: #666666">.</span>add(<span style="color: #BA2121">&quot;Morsel&quot;</span>)
</pre></div>


<h2>Example</h2>
<p>Here is a brief example that will return a few different messages for different routes,
if you run this and open <code>localhost:8000</code> you will see "This is the root" for GET, POST or PUT requests.
The line <code>get(app, "/about") do ...</code> is shorthand for only serving GET requests through that route.</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">using</span> Morsel

app <span style="color: #666666">=</span> Morsel<span style="color: #666666">.</span>app()

route(app, GET <span style="color: #666666">|</span> POST <span style="color: #666666">|</span> PUT, <span style="color: #BA2121">&quot;/&quot;</span>) <span style="color: #008000; font-weight: bold">do</span> req, res
    <span style="color: #BA2121">&quot;This is the root&quot;</span>
<span style="color: #008000; font-weight: bold">end</span>

get(app, <span style="color: #BA2121">&quot;/about&quot;</span>) <span style="color: #008000; font-weight: bold">do</span> req, res
    <span style="color: #BA2121">&quot;This app is running on Morsel&quot;</span>
<span style="color: #008000; font-weight: bold">end</span>

start(app, <span style="color: #666666">8000</span>)
</pre></div>        </article>
        <article id="Meddle">
            <!--!!!Meddle_content-->
<h1>Meddle</h1>
<p>Meddle is a middleware stack for use with <a href="https://github.com/hackerschool/HttpServer.jl">HttpServer.jl</a>.</p>
<h2>Installation:</h2>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># in REQUIRE</span>
Meddle <span style="color: #666666">0.0.1</span>

<span style="color: #408080; font-style: italic"># in REPL</span>
julia<span style="color: #666666">&gt;</span> Pkg2<span style="color: #666666">.</span>add(<span style="color: #BA2121">&quot;Meddle&quot;</span>)
</pre></div>


<h2>Example:</h2>
<p>Define a 'stack' of middleware through which incoming <code>Requests</code> are processed:</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">using</span> HttpServer
<span style="color: #008000; font-weight: bold">using</span> Meddle

stack <span style="color: #666666">=</span> middleware(DefaultHeaders, CookieDecoder, FileServer(pwd()), NotFound)
http <span style="color: #666666">=</span> HttpHandler((req, res)<span style="color: #666666">-&gt;</span>Meddle<span style="color: #666666">.</span>handle(stack, req, res))

<span style="color: #008000; font-weight: bold">for</span> event <span style="color: #008000; font-weight: bold">in</span> split(<span style="color: #BA2121">&quot;connect read write close error&quot;</span>)
    http<span style="color: #666666">.</span>events[event] <span style="color: #666666">=</span> (event<span style="color: #666666">-&gt;</span>(client, args<span style="color: #666666">...</span>)<span style="color: #666666">-&gt;</span>println(client<span style="color: #666666">.</span>id,<span style="color: #BA2121">&quot;: </span><span style="color: #BB6688; font-weight: bold">$</span><span style="color: #BA2121">event&quot;</span>))(event)
<span style="color: #008000; font-weight: bold">end</span>
http<span style="color: #666666">.</span>events[<span style="color: #BA2121">&quot;error&quot;</span>] <span style="color: #666666">=</span> (client, err)<span style="color: #666666">-&gt;</span>println(err)
http<span style="color: #666666">.</span>events[<span style="color: #BA2121">&quot;listen&quot;</span>] <span style="color: #666666">=</span> (port)<span style="color: #666666">-&gt;</span>println(<span style="color: #BA2121">&quot;Listening on </span><span style="color: #BB6688; font-weight: bold">$</span><span style="color: #BA2121">port...&quot;</span>)

server <span style="color: #666666">=</span> Server(http)
run(server, <span style="color: #666666">8000</span>)
</pre></div>        </article>
        <article id="WebSockets">
            <!--!!!WebSockets_content-->
<h1>WebSockets</h1>
<p>This is a server-side implementation of the WebSockets protocol in Julia.
If you want to write a web app in Julia that uses WebSockets, you'll need this package.</p>
<p>This package works with <a href="https://github.com/hackerschool/HttpServer.jl">HttpServer.jl</a>,
which is what you to set up a server that accepts HTTP(S) connections.</p>
<p>As a first example, we can create a WebSockets echo server:</p>
<p>~~~julia
using HttpServer
using WebSockets</p>
<p>wsh = WebSocketHandler() do req,client
    while true
        msg = read(client)
        write(client, msg)
    end
  end</p>
<p>server = Server(wsh)
run(server,8080)
~~~</p>
<p>This sets up a server running on localhost, port 8080.
It will accept WebSockets connections.
The function in <code>wsh</code> will be called once per connection; it takes over that connection.
In this case, it reads each <code>msg</code> from the <code>client</code> and then writes the same message back: a basic echo server.</p>
<p>The function that you pass to the <code>WebSocketHandler</code> constructor takes two arguments:
a <code>Request</code> from <a href="https://github.com/hackerschool/HttpCommon.jl/blob/master/src/HttpCommon.jl#L142">HttpCommon.jl</a>,
and a <code>WebSocket</code> from <a href="https://github.com/hackerschool/WebSockets.jl/blob/master/src/WebSockets.jl#L17">here</a>.</p>
<h2>What can you do with a <code>WebSocket</code>?</h2>
<p>You can:</p>
<ul>
<li><code>write</code> data to it</li>
<li><code>read</code> data from it</li>
<li>send <code>ping</code> or <code>pong</code> messages</li>
<li><code>close</code> the connection</li>
</ul>
<h2>Installation/Setup</h2>
<p>~~~julia
julia&gt; Pkg.add("WebSockets")
~~~</p>
<p>At this point, you can use the examples below to test that it all works.</p>
<h2><a href="https://github.com/hackerschool/WebSockets.jl/blob/master/examples/chat.jl">Chat client/server example</a>:</h2>
<ol>
<li>Move to the <code>~/.julia/WebSockets.jl</code> directory</li>
<li>Run <code>julia examples/chat.jl</code></li>
<li>In a web browser, open <code>localhost:8000</code></li>
<li>You should see a basic IRC-like chat application</li>
</ol>
<h2>Echo server example:</h2>
<p>~~~julia
using HttpServer
using WebSockets</p>
<p>wsh = WebSocketHandler() do req,client
    while true
        msg = read(client)
        write(client, msg)
    end
  end</p>
<p>server = Server(wsh)
run(server,8080)
~~~</p>
<p>To play with a WebSockets echo server, you can:</p>
<ol>
<li>Paste the above code in to the Julia REPL</li>
<li>Open <code>localhost:8080</code> in Chrome</li>
<li>Open the Chrome developers tools console</li>
<li>Type <code>ws = new WebSocket("ws://localhost:8080");</code> into the console</li>
<li>Type <code>ws.send("hi")</code> into the console.</li>
<li>Switch to the 'Network' tab; click on the request; click on the 'frames' tab.</li>
<li>You will see the two frames containing "hi": one sent and one received.</li>
</ol>        </article>
        <article id="HttpServer">
            <!--!!!HttpServer_content-->
<h1>HttpServer</h1>
<p>This is a basic, non-blocking HTTP server in Julia.</p>
<p>You can write a basic application using just this
if you're happy dealing with values representing HTTP requests and responses directly.
For a higher-level view, you could use <a href="https://github.com/hackerschool/Meddle.jl">Meddle</a> or <a href="https://github.com/hackerschool/Morsel.jl">Morsel</a>.
If you'd like to use WebSockets as well, you'll need to grab <a href="https://github.com/hackerschool/WebSockets.jl">WebSockets.jl</a>.</p>
<h2>Installation/Setup</h2>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># in REQUIRE</span>
HttpServer <span style="color: #666666">0.0.1</span>

<span style="color: #408080; font-style: italic"># in REPL</span>
julia<span style="color: #666666">&gt;</span> Pkg2<span style="color: #666666">.</span>add(<span style="color: #BA2121">&quot;HttpServer&quot;</span>)
</pre></div>


<p>To make sure everything is working, you can <code>cd</code> into the <code>~/.julia/HttpServer.jl/</code> and run <code>julia examples/hello.jl</code>. If you open up <code>localhost:8000/hello/name/</code>, you should get a greeting from the server.</p>
<h2>Basic Example:</h2>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">using</span> HttpServer

http <span style="color: #666666">=</span> HttpHandler() <span style="color: #008000; font-weight: bold">do</span> req::Request, res::Response
    Response( ismatch(r<span style="color: #BA2121">&quot;^/hello/&quot;</span>,req<span style="color: #666666">.</span>resource) <span style="color: #666666">?</span> string(<span style="color: #BA2121">&quot;Hello &quot;</span>, split(req<span style="color: #666666">.</span>resource,<span style="color: #BA2121">&#39;/&#39;</span>)[<span style="color: #666666">3</span>], <span style="color: #BA2121">&quot;!&quot;</span>) : <span style="color: #666666">404</span> )
<span style="color: #008000; font-weight: bold">end</span>

http<span style="color: #666666">.</span>events[<span style="color: #BA2121">&quot;error&quot;</span>]  <span style="color: #666666">=</span> ( client, err ) <span style="color: #666666">-&gt;</span> println( err )
http<span style="color: #666666">.</span>events[<span style="color: #BA2121">&quot;listen&quot;</span>] <span style="color: #666666">=</span> ( port )        <span style="color: #666666">-&gt;</span> println(<span style="color: #BA2121">&quot;Listening on </span><span style="color: #BB6688; font-weight: bold">$</span><span style="color: #BA2121">port...&quot;</span>)

server <span style="color: #666666">=</span> Server( http )
run( server, <span style="color: #666666">8000</span> )
</pre></div>        </article>
        <article id="HttpParser">
            <!--!!!HttpParser_content-->
<h1>HttpParser</h1>
<p>This module provides access to Joyent's http-parser library: <a href="https://github.com/joyent/http-parser">http-parser</a></p>
<h2>Installation</h2>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># in REQUIRE</span>
HttpParser <span style="color: #666666">0.0.1</span>

<span style="color: #408080; font-style: italic"># in REPL</span>
julia<span style="color: #666666">&gt;</span> Pkg2<span style="color: #666666">.</span>add(<span style="color: #BA2121">&quot;HttpParser&quot;</span>)
</pre></div>


<h2>Requirements</h2>
<p><code>libhttp-parser</code> needs to be available as a shared library. It should be built automatically by <code>Pkg2</code>.</p>
<h3>Installing libhttp-parser as a shared library manually</h3>
<ol>
<li>clone https://github.com/joyent/http-parser</li>
<li><code>cd http-parser</code></li>
<li><code>make library # Outputs a .so file, should be a .dylib on OS X</code></li>
<li>move the libhttp_parser.so to /usr/local/lib (rename to libhttp_parser.dylib if on OS X)</li>
</ol>
<h2>Test</h2>
<ol>
<li>cd back to HttpParser.jl</li>
<li><code>julia src/Test.jl</code></li>
<li>Expect to see text indicating that all assertions have passed.</li>
</ol>        </article>
        <article id="HttpCommon">
            <!--!!!HttpCommon_content-->
<h1>HttpCommon</h1>
<p>This package provides types and helper functions for dealing with the HTTP protocl in Julia.</p>
<ul>
<li>types to represent <code>Request</code>s, <code>Response</code>s, and <code>Headers</code></li>
<li>a dictionary of <code>STATUS_CODES</code>
    (maps integer codes to string descriptions; covers all the codes from the RFCs)</li>
<li>a bitmask representation of HTTP request methods</li>
<li>a function to <code>escapeHTML</code> in a <code>String</code></li>
<li>a pair of functions to <code>encodeURI</code> and <code>decodeURI</code></li>
<li>a function to turn a query string from a url into a <code>Dict{String,String}</code></li>
</ul>
<h1>Installation</h1>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># in REQUIRE</span>
HttpCommon <span style="color: #666666">0.0.1</span>

<span style="color: #408080; font-style: italic"># in REPL</span>
julia<span style="color: #666666">&gt;</span> Pkg2<span style="color: #666666">.</span>add(<span style="color: #BA2121">&quot;HttpCommon&quot;</span>)
</pre></div>


<p>You will need to have Julia installed from source because this code has not been tested in v0.1 at all and probably uses features not found there.</p>        </article>
    </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="js/vendor/jquery.1.10.2.min.js"><\/script>');
    </script>
    <script src="js/main.js"></script>
    <!--
    <script>
        var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src='//www.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
    -->
</body>
</html>
